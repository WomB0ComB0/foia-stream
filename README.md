<!--
  Generated by AI-Powered README Generator
  Repository: https://github.com/FOIA-Stream/foia-stream
  Generated: 2025-12-29T20:20:48.270Z
  Format: md
  Style: comprehensive
-->

# üèõÔ∏è FOIA Stream

> **Empowering Public Transparency through Automated Records Management and Agency Accountability.**

FOIA Stream is a high-performance, full-stack monorepo designed to bridge the gap between government agencies and the public. By automating the lifecycle of Freedom of Information Act (FOIA) requests‚Äîfrom drafting and jurisdiction routing to deadline tracking and secure document disclosure‚Äîit transforms a complex legal process into a streamlined, digital workflow.

[![Build Status](https://img.shields.io/badge/build-passing-brightgreen)](#)
[![License](https://img.shields.io/badge/license-MIT-blue)](#)
[![Version](https://img.shields.io/badge/version-1.0.0-orange)](#)
[![Runtime](https://img.shields.io/badge/runtime-Bun-black)](#)
[![Frontend](https://img.shields.io/badge/frontend-Astro%20%2F%20React-ff5d01)](#)
[![Backend](https://img.shields.io/badge/backend-Hono-00adff)](#)

---

## üìë Table of Contents

- [üîç Overview](#-overview)
- [‚ú® Feature Highlights](#-feature-highlights)
- [üèóÔ∏è Architecture & Design](#Ô∏è-architecture--design)
- [üöÄ Getting Started](#-getting-started)
- [üìñ Usage & Workflows](#-usage--workflows)
- [üîê Security & Compliance](#-security--compliance)
- [üõ†Ô∏è Development & Contributing](#Ô∏è-development--contributing)
- [üó∫Ô∏è Roadmap & Limitations](#Ô∏è-roadmap--limitations)
- [üìÑ License & Contact](#-license--contact)
- [‚ùì FAQ & Troubleshooting](#-faq--troubleshooting)

---

## üîç Overview

**FOIA Stream** is built on the belief that transparency is the bedrock of democracy. While the law mandates public access to records, the practical hurdles‚Äîmissed deadlines, fragmented communication, and opaque filing systems‚Äîoften render those rights inaccessible.

### The Mission
To provide a centralized "Command Center" that professionalizes public records requests. FOIA Stream offers tools for investigative journalists, legal advocates, and concerned citizens to track government responsiveness in real-time.

### Why FOIA Stream?
- **For Citizens:** Remove the guesswork. Use legally-vetted templates and automatic agency routing.
- **For Journalists:** Manage bulk requests across hundreds of jurisdictions with automated follow-ups.
- **For Agencies:** Manage high-volume disclosures with built-in redaction workflows and audit logs.

[Back to top ‚Üë](#-table-of-contents)

---

## ‚ú® Feature Highlights

### üìã Request Management
- **Smart Templates:** Pre-configured drafts for police body-cam footage, use-of-force reports, and financial audits.
- **Deadline Monitoring:** Automated countdowns based on state-specific statutory response times.
- **Status Dashboard:** Visual pipeline moving from `Draft` ‚Üí `Submitted` ‚Üí `In Progress` ‚Üí `Fulfilled`.

### üè¢ Agency Intelligence
- **Verified Directory:** A searchable database of state and local agency contact information.
- **Compliance Scores:** Public-facing metrics on how quickly and thoroughly agencies respond.
- **Jurisdiction Mapping:** Automatic identification of the correct "Records Access Officer".

### üõ°Ô∏è Redaction & Security
- **PDF Redaction Engine:** High-fidelity document redaction that ensures "true" removal of sensitive metadata.
- **Auto-Redaction:** AI-assisted detection of PII (Names, SSNs, Addresses) within uploaded documents.
- **VirusTotal Integration:** Automated malware scanning for all incoming agency responses.

> üí° **Tip:** Use the **Agency Search** component to find the specific "Records Access Officer" email, preventing your request from getting lost in a general "Contact Us" inbox.

[Back to top ‚Üë](#-table-of-contents)

---

## üèóÔ∏è Architecture & Design

FOIA Stream utilizes a **Turborepo** monorepo structure, optimized for the **Bun** runtime. This ensures unified type safety and extreme performance across the entire stack.

### System Component Diagram

```mermaid
graph TD
    subgraph Client_Layer [Frontend: Astro + React]
        UI[User Dashboard]
        Viewer[PDF Redaction Viewer]
        Forms[Request Wizard]
    end

    subgraph API_Layer [Backend: Hono + Bun]
        Gateway[Hono API]
        AuthSvc[Auth & MFA Service]
        RedactSvc[Redaction Engine]
        AgencySvc[Agency Search Service]
    end

    subgraph Persistence [Data Layer]
        DB[(SQLite + Drizzle)]
        Cache[LRU Cache]
        Files[Encrypted File Storage]
    end

    UI --> Gateway
    Gateway --> AuthSvc
    Gateway --> RedactSvc
    Gateway --> AgencySvc
    AuthSvc --> DB
    RedactSvc --> Files
    AgencySvc --> Cache
```

### Core Request Processing Flow

```mermaid
sequenceDiagram
    participant User
    participant API
    participant Redactor
    participant Storage

    User->>API: Upload Document for Redaction
    API->>API: VirusTotal Malware Scan
    API->>Storage: Store Temporary File
    API->>Redactor: Analyze PII (Auto-Redaction)
    Redactor-->>API: Identified Redaction Coordinates
    API-->>User: Preview Redactions in UI
    User->>API: Confirm & Flatten PDF
    API->>Storage: Store "True Redacted" Version
    API-->>User: Download Final Document
```

### Technology Stack breakdown

| Layer | Technology | Purpose |
| :--- | :--- | :--- |
| **Runtime** | [Bun](https://bun.sh/) | Fast JavaScript all-in-one runtime. |
| **Frontend** | [Astro](https://astro.build/) | Content-focused web framework for the landing and app shells. |
| **UI Components** | [React](https://reactjs.org/) | Interactive "islands" for dashboards and redaction tools. |
| **API** | [Hono](https://hono.dev/) | Ultrafast web framework for the API layer. |
| **ORM** | [Drizzle](https://orm.drizzle.team/) | Type-safe SQL interactions. |
| **Database** | [SQLite](https://sqlite.org/) | Local-first, portable database. |
| **Lint/Format** | [Biome](https://biomejs.dev/) | High-performance toolchain replacing Prettier/ESLint. |

[Back to top ‚Üë](#-table-of-contents)

---

## üöÄ Getting Started

### Prerequisites
- **Bun >= 1.1.0**
- **SQLite 3**
- A [VirusTotal API Key](https://www.virustotal.com/) (Optional, for document scanning)

### Installation

1. **Clone the repository:**
   ```bash
   git clone https://github.com/FOIA-Stream/foia-stream.git
   cd foia-stream
   ```

2. **Install dependencies:**
   ```bash
   bun install
   ```

3. **Configure Environment:**
   ```bash
   cp apps/api/.env.example apps/api/.env
   ```
   Edit `apps/api/.env` to include your `DATABASE_URL` and `JWT_SECRET`.

4. **Initialize Database:**
   ```bash
   bun run db:generate --filter=api
   bun run db:migrate --filter=api
   bun run db:seed --filter=api
   ```

### Running the Application

| Environment | Command |
| :--- | :--- |
| **Development** | `bun run dev` |
| **Build** | `bun run build` |
| **Test** | `bun run test` |
| **Linting** | `bun run lint` |

[Back to top ‚Üë](#-table-of-contents)

---

## üìñ Usage & Workflows

### Creating a FOIA Request
1. Navigate to the **Dashboard**.
2. Click **"New Request"**.
3. Use the **Agency Search** to find your target jurisdiction.
4. Select a **Template** (e.g., "General Records Request").
5. The system will automatically calculate the expected response date based on local laws.

### Document Redaction Workflow
<details>
<summary><b>View Redaction Steps</b></summary>

1. Upload your received PDF to the **Documents** section.
2. Open the **Redaction Viewer**.
3. Use the "Auto-Suggest" feature to highlight PII.
4. Manually draw boxes over any remaining sensitive info.
5. Click **"Flatten & Export"** to generate a clean PDF where the data is physically removed, not just hidden.
</details>

### CLI Support
The API includes various management scripts:
```bash
# Backup the database
bun run apps/api/src/services/operations/backup.service.ts

# Trigger data retention cleanup
bun run apps/api/src/services/operations/data-retention.service.ts
```

[Back to top ‚Üë](#-table-of-contents)

---

## üîê Security & Compliance

We take data privacy seriously. FOIA Stream includes a dedicated `compliance/` directory with extensive documentation on:

*   **PII Data Flow Analysis:** Detailed mapping of how personal information moves through the system.
*   **Data Retention:** Automated purging of expired documents to minimize legal risk.
*   **Encryption:** Field-level encryption for sensitive database columns using AES-256.
*   **Audit Logging:** Comprehensive tracking of all request modifications and document access.

‚ö†Ô∏è **Warning:** Always verify redactions manually. While our `pdf-true-redaction.service.ts` uses advanced flattening, no automated tool is 100% foolproof for legal disclosure.

[Back to top ‚Üë](#-table-of-contents)

---

## üõ†Ô∏è Development & Contributing

### Repository Structure
- `apps/api`: Hono backend, Drizzle schemas, and core business logic.
- `apps/astro`: Main frontend application and user dashboard.
- `packages/shared`: Shared Zod schemas, types, and utility functions (DSA, sanitization).
- `compliance/`: Policies, runbooks, and impact assessments.

### Standards
- **Code Style:** We use [Biome](https://biomejs.dev/). Run `bun run lint` before committing.
- **Testing:** We use Vitest for unit tests and Cypress for E2E.
- **Branching:** `main` is protected. Please use feature branches (`feat/...`, `fix/...`).

[Back to top ‚Üë](#-table-of-contents)

---

## üó∫Ô∏è Roadmap & Limitations

### Known Limitations
- **File Types:** Redaction is currently limited to PDF files. Support for `.docx` and `.xlsx` is planned.
- **Database:** Optimized for SQLite; PostgreSQL support is in the roadmap for high-traffic instances.

### Future Roadmap
- [ ] **AI-Powered Analysis:** Use LLMs to summarize long document disclosures.
- [ ] **Bulk Filing:** Ability to send one request to multiple agencies simultaneously.
- [ ] **Email Integration:** Direct IMAP/SMTP sync to track agency correspondence within the dashboard.
- [ ] **Mobile App:** React Native companion app for on-the-go tracking.

[Back to top ‚Üë](#-table-of-contents)

---

## üìÑ License & Contact

**License:** Distributed under the MIT License. See `LICENSE` for more information.

**Maintainers:**
- **Project Lead:** [FOIA Stream Team](https://github.com/FOIA-Stream)
- **Security:** security@foia-stream.org

**Support:** Open an [Issue](https://github.com/FOIA-Stream/foia-stream/issues) or join our community discussions.

---

## ‚ùì FAQ & Troubleshooting

### FAQ
**Q: Does FOIA Stream send the emails for me?**
A: Currently, FOIA Stream generates the request and provides the contact details. Automated SMTP sending is a planned feature.

**Q: Where is my data stored?**
A: By default, all data is stored locally in the `apps/api/data/` directory.

### Troubleshooting
| Issue | Solution |
| :--- | :--- |
| **Database Lock Error** | Ensure no other process is accessing `foia-stream.db`. Restart the Bun dev server. |
| **PDF Rendering Fail** | Check if the `pdf.worker.min.mjs` is correctly loaded in `public/`. |
| **MFA Setup Fail** | Ensure your system clock is synchronized (TOTP is time-sensitive). |

[Back to top ‚Üë](#-table-of-contents)